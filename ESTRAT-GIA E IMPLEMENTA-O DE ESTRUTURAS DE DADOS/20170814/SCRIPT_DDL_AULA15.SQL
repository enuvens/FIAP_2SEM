-- ARQUIVO: SCRIPT_SQL_AULA15.DDL
-- COMANDOS DDL: ALTER TABLE
-- DROP TABLE T_TESTE CASCADE CONSTRAINT;

CREATE TABLE T_TESTE
(
  cd_teste    NUMBER(3)    NOT NULL ,
  nm_teste    VARCHAR2(40) NOT NULL
);

   ALTER TABLE T_TESTE
ADD CONSTRAINT PK_TESTE
   PRIMARY KEY (cd_teste);

   ALTER TABLE T_TESTE   
ADD CONSTRAINT UN_TESTE_NOME
        UNIQUE (NM_TESTE);
        
--EXEMPLOS DE ALTER TABLE
-- INCLUIR UMA COLUNA EM UMA TABELA JÁ EXISTENTE
ALTER TABLE T_TESTE
        ADD ds_email VARCHAR2(50) UNIQUE;

-- ALTERAR UMA COLUNA EXISTENTE
-- SERÁ ALTERADO O TAMANHO E INSERIDA A CONSTRAINT NOT NULL
ALTER TABLE T_TESTE
     MODIFY ds_email VARCHAR2(80) NOT NULL;
     
-- ELIMINAÇÃO DE COLUNA
ALTER TABLE T_TESTE
DROP COLUMN ds_email;

-- ELIMINANDO UMA UNIQUE CONSTRAINT
    ALTER TABLE T_TESTE
DROP CONSTRAINT UN_TESTE_NOME;

-- ELIMINANDO UMA PRIMARY KEY
-- CASO EXISTA RELACIONAMENTO, INCLUIR A CLAUSULA CASCADE
-- NO FINAL DO COMANDO,PARA ELIMINAR O RELACIONAMENTO
    ALTER TABLE T_TESTE
DROP CONSTRAINT PK_TESTE;

-- RENOMEANDO A TABELA
ALTER TABLE T_TESTE
     RENAME TO T_TESTE_NOVO;
     
-- RENOMEANDO UMA COLUNA DA TABELA
  ALTER TABLE T_TESTE_NOVO
RENAME COLUMN nm_teste TO nm_teste_novo;

-- CRIAR CONSTRAINT UNIQUE
   ALTER TABLE T_TESTE_NOVO   
ADD CONSTRAINT UN_TESTE_NOME_NOVO
        UNIQUE (NM_TESTE_NOVO);

-- RENOMEAR O NOME DA CONSTRAINT
      ALTER TABLE T_TESTE_NOVO
RENAME CONSTRAINT UN_TESTE_NOME_NOVO TO UN_TESTE_NOME_NOVO_NOVO;


-- DESABILITAR CONSTRAINT (DESLIGANDO A RESTRIÇÃO)
-- A RESTRIÇÃO NÃO É UTILIZADA DURANTE A INSERÇÃO/ATUALIZACAO DOS
-- REGISTROS NA TABELA
       ALTER TABLE T_TESTE_NOVO
DISABLE CONSTRAINT UN_TESTE_NOME_NOVO_NOVO;

-- HABILITAR CONSTRAINT (LIGANDO A RESTRIÇÃO)
-- A RESTRIÇÃO É UTILIZADA DURANTE A INSERÇÃO/ATUALIZACAO DOS
-- REGISTROS NA TABELA
       ALTER TABLE T_TESTE_NOVO
ENABLE CONSTRAINT UN_TESTE_NOME_NOVO_NOVO;

-- COMANDOS SELECT,QUE AUXILIAM NA VISUALIZAÇÃO 
-- DE TABELAS E CONSTRAINTS DA ESTRUTURA
SELECT OWNER, TABLE_NAME 
  FROM ALL_TABLES
 WHERE TABLE_NAME LIKE 'T_SIP%';

SELECT OWNER, TABLE_NAME 
  FROM ALL_TABLES
 WHERE TABLE_NAME = 'T_SIP_BAIRRO';

-- CONSULTAR AS CONSTRAINTS
SELECT * FROM ALL_CONSTRAINTS;

SELECT TABLE_NAME, 
       CONSTRAINT_NAME,
       CONSTRAINT_TYPE,
       SEARCH_CONDITION
  FROM ALL_CONSTRAINTS
 WHERE TABLE_NAME = 'T_SIP_FUNCIONARIO';
 